<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>二维码扫描下载文件用</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="css/app.css" />
        <script src="js/mui.min.js"></script>
        <script>
        	mui.plusReady(function(){
        	      var curr=plus.webview.currentWebview();
        	      var result=curr.result;
        	      var w=plus.nativeUI.showWaiting('开始下载。。。。。');
        	      var options ={method:'GET'};
        	      var dd=null;
        	      var dtask=plus.downloader.createDownload(result,options,function(d,status){
        	      	dd=d.filename;
        	      	plus.runtime.install(dd,{});
        	      	plus.runtime.restart();
        	      });
        	      dtask.start();
        	      dtask.addEventListener("statechanged",function(task,status){
        	      	switch(task.state){
        	      		case 1:
        	      		w.setTitle("开始下载....");
        	      		break;
        	      		case 2:
        	      		w.setTitle("开始下载....");
        	      		break;
        	      		case 3:
        	      		var a=task.downloadedSize/task.totalSize*100;
        	      		w.setTitle("   已下载"+parseInt(a)+"%   ");
        	      		break;
        	      		case 4:
        	      		w.setTitle('   下载完成     ');
        	      		w.close();
        	      		break;
        	      	}
        	      });
        	      
        	});
        	
        </script>
	</head>
	<body>
	</body>
</html>
